name: 'Full Stack CI/CD Pipeline'

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # Job 1: Code Quality & Linting
  lint:
    name: Code Quality Check
    runs-on: ubuntu-latest
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
    
    - name: Set up Python 3.12
      uses: actions/setup-python@v4
      with:
        python-version: 3.12
        
    - name: Set up Node.js 18
      uses: actions/setup-node@v4
      with:
        node-version: 18
        
    - name: Install Python Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install flake8 django
        
    - name: Install JavaScript Dependencies
      run: npm install jshint --global
      
    - name: Lint Python Code
      run: |
        echo "ğŸ Linting Python files..."
        find . -name "*.py" -not -path "*/migrations/*" -not -path "*/djangoenv/*" -not -path "*/node_modules/*" -exec flake8 {} +
        echo "âœ… Python linting completed successfully"
        
    - name: Lint JavaScript Code
      run: |
        echo "ğŸŸ¨ Linting JavaScript files..."
        find ./server/database -name "*.js" -not -path "*/node_modules/*" -exec jshint {} +
        echo "âœ… JavaScript linting completed successfully"

  # Job 2: Build & Test Backend
  test-backend:
    name: Test Django Backend
    runs-on: ubuntu-latest
    needs: lint
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
      
    - name: Set up Python 3.12
      uses: actions/setup-python@v4
      with:
        python-version: 3.12
        
    - name: Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install django djangorestframework requests python-dotenv
        
    - name: Run Django Tests
      working-directory: ./server
      run: |
        echo "ğŸ§ª Running Django backend tests..."
        python manage.py check
        python manage.py makemigrations --check --dry-run
        echo "âœ… Django backend tests passed"

  # Job 3: Build Frontend
  build-frontend:
    name: Build React Frontend
    runs-on: ubuntu-latest
    needs: lint
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
      
    - name: Set up Node.js 18
      uses: actions/setup-node@v4
      with:
        node-version: 18
        cache: 'npm'
        cache-dependency-path: './server/frontend/package-lock.json'
        
    - name: Install Frontend Dependencies
      working-directory: ./server/frontend
      run: |
        echo "ğŸ“¦ Installing React dependencies..."
        npm ci
        
    - name: Update Browserslist Database
      working-directory: ./server/frontend
      run: |
        echo "ğŸ”„ Updating browserslist database..."
        npx update-browserslist-db@latest
        
    - name: Build React Application
      working-directory: ./server/frontend
      run: |
        echo "âš›ï¸ Building React application..."
        CI=false npm run build
        echo "âœ… React build completed successfully"
        
    - name: Upload Build Artifacts
      uses: actions/upload-artifact@v4
      with:
        name: react-build
        path: ./server/frontend/build/
        retention-days: 1

  # Job 4: Create Demo Documentation
  create-demo:
    name: Create Demo Documentation
    runs-on: ubuntu-latest
    needs: [test-backend, build-frontend]
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
      
    - name: Download React Build
      uses: actions/download-artifact@v4
      with:
        name: react-build
        path: ./demo/app/
        
    - name: Create Demo Website
      run: |
        echo "ğŸŒ Creating demo website..."
        mkdir -p demo/docs
        
        # Copy React app to root for direct access
        cp -r ./demo/app/* ./demo/
        
        # Create a static data file for demo purposes
        mkdir -p ./demo/static/js
        cat > ./demo/static/js/demo-data.js << 'EOF'
        // Demo data for static GitHub Pages deployment
        window.DEMO_MODE = true;
        window.DEMO_DEALERS = [
          {id: 1, full_name: "Luxury Motors Dallas", city: "Dallas", state: "Texas", address: "123 Main St", zip: "75201"},
          {id: 2, full_name: "Premium Auto Houston", city: "Houston", state: "Texas", address: "456 Oak Ave", zip: "77001"},
          {id: 3, full_name: "Elite Cars Austin", city: "Austin", state: "Texas", address: "789 Pine Rd", zip: "73301"},
          {id: 4, full_name: "Metro Motors NYC", city: "New York", state: "New York", address: "321 Broadway", zip: "10001"},
          {id: 5, full_name: "Golden Gate Auto", city: "San Francisco", state: "California", address: "654 Market St", zip: "94102"}
        ];
        window.DEMO_REVIEWS = [
          {id: 1, name: "John Doe", review: "Excellent service and great cars!", sentiment: "positive", car_make: "Toyota", car_model: "Camry", car_year: 2023},
          {id: 2, name: "Jane Smith", review: "Good experience overall", sentiment: "neutral", car_make: "Honda", car_model: "Civic", car_year: 2022},
          {id: 3, name: "Mike Johnson", review: "Outstanding dealership!", sentiment: "positive", car_make: "BMW", car_model: "X5", car_year: 2023}
        ];
        EOF
        
        # Create main demo page that includes both landing and app
        cat > demo/index.html << 'EOF'
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>ğŸš— Dealership Application - Full Stack Demo</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body { 
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    line-height: 1.6; color: #333; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    min-height: 100vh;
                }
                .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
                .header { text-align: center; color: white; margin-bottom: 40px; }
                .header h1 { font-size: 3rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
                .header p { font-size: 1.2rem; opacity: 0.9; }
                .demo-section { background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 30px; }
                .demo-section h2 { color: #667eea; margin-bottom: 20px; font-size: 2rem; }
                .cta-button { 
                    display: inline-block; background: #28a745; color: white; padding: 15px 30px; 
                    text-decoration: none; border-radius: 25px; font-weight: bold; 
                    transition: background 0.3s; margin: 10px; text-decoration: none;
                }
                .cta-button:hover { background: #218838; }
                .app-button { background: #667eea; }
                .app-button:hover { background: #5a6fd8; }
                .github-link { background: #333; }
                .github-link:hover { background: #555; }
                .status-badge { 
                    display: inline-block; background: #28a745; color: white; 
                    padding: 5px 15px; border-radius: 15px; font-size: 0.8rem; margin: 5px;
                }
                .tech-stack { display: flex; flex-wrap: wrap; gap: 10px; margin: 20px 0; }
                .tech { background: #667eea; color: white; padding: 8px 16px; border-radius: 20px; font-size: 0.9rem; }
                .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 40px; }
                .feature { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); transition: transform 0.3s; }
                .feature:hover { transform: translateY(-5px); }
                .feature h3 { color: #667eea; margin-bottom: 15px; font-size: 1.5rem; }
                .feature ul { list-style: none; }
                .feature li { padding: 5px 0; }
                .feature li:before { content: "âœ… "; color: #28a745; }
                @media (max-width: 768px) {
                    .header h1 { font-size: 2rem; }
                    .container { padding: 10px; }
                    .features { grid-template-columns: 1fr; }
                }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="header">
                    <h1>ğŸš— Dealership Application</h1>
                    <p>Full Stack Developer Capstone Project</p>
                    <div style="margin-top: 20px;">
                        <span class="status-badge">âœ… CI/CD Pipeline</span>
                        <span class="status-badge">âœ… Fully Tested</span>
                        <span class="status-badge">âœ… Production Ready</span>
                    </div>
                </div>

                <div class="demo-section">
                    <h2>ğŸ¯ Project Overview</h2>
                    <p>A comprehensive full-stack web application for car dealership management with review system, sentiment analysis, and modern UI/UX. This project demonstrates advanced software engineering practices including CI/CD, containerization, and cloud deployment.</p>
                    
                    <div class="tech-stack">
                        <span class="tech">ğŸ Django</span>
                        <span class="tech">âš›ï¸ React</span>
                        <span class="tech">ğŸŸ¨ Node.js</span>
                        <span class="tech">ğŸƒ MongoDB</span>
                        <span class="tech">ğŸ³ Docker</span>
                        <span class="tech">â˜¸ï¸ Kubernetes</span>
                        <span class="tech">ğŸš€ GitHub Actions</span>
                        <span class="tech">ğŸ¤– AI Sentiment Analysis</span>
                    </div>
                </div>

                <div class="demo-section">
                    <h2>ğŸš€ Live Application Demo</h2>
                    <p><strong>Experience the full React application with interactive features:</strong></p>
                    <div style="text-align: center; margin-top: 20px;">
                        <a href="./app.html" class="cta-button app-button">ğŸŒ Launch React Application</a>
                        <a href="https://github.com/Braininhood/xrwvm-fullstack_developer_capstone" class="cta-button github-link">ğŸ“± View Source Code</a>
                    </div>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                        <em>Note: This is a static demo version. The full application with backend services runs localy/your cloud (server) with Docker.</em>
                    </p>
                </div>

                <div class="features">
                    <div class="feature">
                        <h3>ğŸª Dealership Management</h3>
                        <ul>
                            <li>Browse 50+ dealerships across multiple states</li>
                            <li>Filter dealerships by location</li>
                            <li>View detailed dealership information</li>
                            <li>Interactive dealer listings</li>
                        </ul>
                    </div>
                    
                    <div class="feature">
                        <h3>ğŸ“ Review System</h3>
                        <ul>
                            <li>Post authenticated reviews</li>
                            <li>Real-time sentiment analysis</li>
                            <li>View reviews with sentiment indicators</li>
                            <li>Secure review posting</li>
                        </ul>
                    </div>
                    
                    <div class="feature">
                        <h3>ğŸš— Car Database</h3>
                        <ul>
                            <li>15+ car models from 5 manufacturers</li>
                            <li>Complete car specifications</li>
                            <li>Admin interface for management</li>
                            <li>Advanced filtering options</li>
                        </ul>
                    </div>
                    
                    <div class="feature">
                        <h3>ğŸ”§ DevOps & CI/CD</h3>
                        <ul>
                            <li>Automated testing pipeline</li>
                            <li>Code quality checks</li>
                            <li>Docker containerization</li>
                            <li>Kubernetes deployment</li>
                        </ul>
                    </div>
                </div>

                <div style="text-align: center; color: white; margin-top: 40px;">
                    <p>Built with â¤ï¸ using modern web technologies</p>
                    <p>Â© 2024 Full Stack Developer Capstone Project</p>
                </div>
            </div>
        </body>
        </html>
        EOF
        
        # Create app.html that loads the React application
        cat > demo/app.html << 'DEMO_EOF'
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width,initial-scale=1">
            <title>ğŸš— Dealership Application Demo</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body { font-family: Arial, sans-serif; background: #f5f5f5; }
                .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
                .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
                .nav { background: white; padding: 15px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
                .nav button { padding: 12px 24px; margin: 0 10px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
                .nav button:hover { background: #5a6fd8; }
                .nav button.active { background: #28a745; }
                .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
                .section { background: white; padding: 30px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
                .hidden { display: none; }
                .dealers-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-top: 20px; }
                .dealer-card { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; }
                .dealer-name { font-size: 1.4rem; font-weight: bold; color: #667eea; margin-bottom: 10px; }
                .dealer-info { margin: 8px 0; color: #666; }
                .dealer-actions { margin-top: 15px; }
                .btn { padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px; text-decoration: none; display: inline-block; }
                .btn:hover { background: #218838; }
                .btn-secondary { background: #6c757d; }
                .btn-secondary:hover { background: #5a6268; }
                .filter-section { background: #e9ecef; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
                .filter-select { padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-right: 10px; font-size: 16px; }
                .review-card { background: #f8f9fa; padding: 20px; margin-bottom: 15px; border-radius: 8px; border-left: 4px solid #667eea; }
                .review-text { font-style: italic; margin-bottom: 10px; font-size: 1.1rem; }
                .review-author { font-weight: bold; color: #667eea; }
                .sentiment { padding: 4px 12px; border-radius: 15px; font-size: 0.9rem; margin-left: 10px; }
                .sentiment.positive { background: #d4edda; color: #155724; }
                .sentiment.negative { background: #f8d7da; color: #721c24; }
                .sentiment.neutral { background: #d1ecf1; color: #0c5460; }
                .tech-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0; }
                .tech-item { background: #667eea; color: white; padding: 15px; border-radius: 8px; text-align: center; }
                @media (max-width: 768px) {
                    .dealers-grid { grid-template-columns: 1fr; }
                    .header h1 { font-size: 2rem; }
                    .nav button { margin: 5px; padding: 10px 16px; }
                }
            </style>
        </head>
        <body>
            <div class="header">
                <h1>ğŸš— Dealership Application</h1>
                <p>Interactive Demo - Full Stack Developer Capstone</p>
            </div>
            
            <div class="nav">
                <button onclick="showSection('dealers')" class="active" id="dealers-btn">ğŸª Browse Dealers</button>
                <button onclick="showSection('reviews')" id="reviews-btn">ğŸ“ Reviews</button>
                <button onclick="showSection('about')" id="about-btn">â„¹ï¸ About</button>
                <button onclick="window.location.href='../'" id="home-btn">ğŸ  Home</button>
            </div>

            <div class="container">
                <div id="dealers-section" class="section">
                    <h2>ğŸª Browse Dealerships</h2>
                    <div class="filter-section">
                        <label for="state-filter"><strong>Filter by State:</strong></label>
                        <select id="state-filter" class="filter-select" onchange="filterDealers()">
                            <option value="all">All States</option>
                            <option value="Texas">Texas</option>
                            <option value="New York">New York</option>
                            <option value="California">California</option>
                        </select>
                        <span id="dealer-count" style="font-weight: bold; color: #667eea;">5 dealerships found</span>
                    </div>
                    <div id="dealers-grid" class="dealers-grid">
                        <div class="dealer-card">
                            <div class="dealer-name">Luxury Motors Dallas</div>
                            <div class="dealer-info">ğŸ“ Dallas, Texas</div>
                            <div class="dealer-info">ğŸ  123 Main St</div>
                            <div class="dealer-info">ğŸ“® 75201</div>
                            <div class="dealer-actions">
                                <button class="btn" onclick="viewDealerReviews(1, 'Luxury Motors Dallas')">ğŸ“ View Reviews</button>
                                <button class="btn btn-secondary" onclick="showDealerDetails('Luxury Motors Dallas', '123 Main St', 'Dallas, Texas 75201')">â„¹ï¸ Details</button>
                            </div>
                        </div>
                        <div class="dealer-card">
                            <div class="dealer-name">Premium Auto Houston</div>
                            <div class="dealer-info">ğŸ“ Houston, Texas</div>
                            <div class="dealer-info">ğŸ  456 Oak Ave</div>
                            <div class="dealer-info">ğŸ“® 77001</div>
                            <div class="dealer-actions">
                                <button class="btn" onclick="viewDealerReviews(2, 'Premium Auto Houston')">ğŸ“ View Reviews</button>
                                <button class="btn btn-secondary" onclick="showDealerDetails('Premium Auto Houston', '456 Oak Ave', 'Houston, Texas 77001')">â„¹ï¸ Details</button>
                            </div>
                        </div>
                        <div class="dealer-card">
                            <div class="dealer-name">Elite Cars Austin</div>
                            <div class="dealer-info">ğŸ“ Austin, Texas</div>
                            <div class="dealer-info">ğŸ  789 Pine Rd</div>
                            <div class="dealer-info">ğŸ“® 73301</div>
                            <div class="dealer-actions">
                                <button class="btn" onclick="viewDealerReviews(3, 'Elite Cars Austin')">ğŸ“ View Reviews</button>
                                <button class="btn btn-secondary" onclick="showDealerDetails('Elite Cars Austin', '789 Pine Rd', 'Austin, Texas 73301')">â„¹ï¸ Details</button>
                            </div>
                        </div>
                        <div class="dealer-card">
                            <div class="dealer-name">Metro Motors NYC</div>
                            <div class="dealer-info">ğŸ“ New York, New York</div>
                            <div class="dealer-info">ğŸ  321 Broadway</div>
                            <div class="dealer-info">ğŸ“® 10001</div>
                            <div class="dealer-actions">
                                <button class="btn" onclick="viewDealerReviews(4, 'Metro Motors NYC')">ğŸ“ View Reviews</button>
                                <button class="btn btn-secondary" onclick="showDealerDetails('Metro Motors NYC', '321 Broadway', 'New York, New York 10001')">â„¹ï¸ Details</button>
                            </div>
                        </div>
                        <div class="dealer-card">
                            <div class="dealer-name">Golden Gate Auto</div>
                            <div class="dealer-info">ğŸ“ San Francisco, California</div>
                            <div class="dealer-info">ğŸ  654 Market St</div>
                            <div class="dealer-info">ğŸ“® 94102</div>
                            <div class="dealer-actions">
                                <button class="btn" onclick="viewDealerReviews(5, 'Golden Gate Auto')">ğŸ“ View Reviews</button>
                                <button class="btn btn-secondary" onclick="showDealerDetails('Golden Gate Auto', '654 Market St', 'San Francisco, California 94102')">â„¹ï¸ Details</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="reviews-section" class="section hidden">
                    <h2>ğŸ“ Customer Reviews</h2>
                    <p style="margin-bottom: 20px;">Real customer feedback with AI-powered sentiment analysis</p>
                    <div id="reviews-container">
                        <div class="review-card">
                            <div class="review-text">"Excellent service and great cars! The staff was very helpful and professional."</div>
                            <div class="review-author">
                                John Doe - Toyota Camry 2023
                                <span class="sentiment positive">ğŸ˜Š Positive</span>
                            </div>
                            <div style="margin-top: 10px; color: #666;">ğŸ“ Luxury Motors Dallas</div>
                        </div>
                        <div class="review-card">
                            <div class="review-text">"Good experience overall, but could improve on wait times."</div>
                            <div class="review-author">
                                Jane Smith - Honda Civic 2022
                                <span class="sentiment neutral">ğŸ˜ Neutral</span>
                            </div>
                            <div style="margin-top: 10px; color: #666;">ğŸ“ Luxury Motors Dallas</div>
                        </div>
                        <div class="review-card">
                            <div class="review-text">"Outstanding dealership! Best car buying experience ever."</div>
                            <div class="review-author">
                                Mike Johnson - BMW X5 2023
                                <span class="sentiment positive">ğŸ˜Š Positive</span>
                            </div>
                            <div style="margin-top: 10px; color: #666;">ğŸ“ Premium Auto Houston</div>
                        </div>
                        <div class="review-card">
                            <div class="review-text">"Terrible customer service and overpriced vehicles."</div>
                            <div class="review-author">
                                Sarah Wilson - Ford F-150 2022
                                <span class="sentiment negative">ğŸ˜ Negative</span>
                            </div>
                            <div style="margin-top: 10px; color: #666;">ğŸ“ Elite Cars Austin</div>
                        </div>
                        <div class="review-card">
                            <div class="review-text">"Professional staff and competitive prices. Highly recommended!"</div>
                            <div class="review-author">
                                David Brown - Mercedes C-Class 2023
                                <span class="sentiment positive">ğŸ˜Š Positive</span>
                            </div>
                            <div style="margin-top: 10px; color: #666;">ğŸ“ Metro Motors NYC</div>
                        </div>
                    </div>
                </div>

                <div id="about-section" class="section hidden">
                    <h2>â„¹ï¸ About This Demo</h2>
                    <p style="font-size: 1.1rem; margin-bottom: 20px;"><strong>This is a static demo version of the full-stack dealership application.</strong></p>
                    
                    <h3 style="color: #667eea; margin: 20px 0 15px 0;">ğŸ”§ Technologies Demonstrated:</h3>
                    <div class="tech-list">
                        <div class="tech-item"><strong>Frontend:</strong><br>React, Bootstrap, Responsive Design</div>
                        <div class="tech-item"><strong>Backend:</strong><br>Django REST API, Node.js</div>
                        <div class="tech-item"><strong>Database:</strong><br>MongoDB, SQLite</div>
                        <div class="tech-item"><strong>AI/ML:</strong><br>NLTK Sentiment Analysis</div>
                        <div class="tech-item"><strong>DevOps:</strong><br>Docker, Kubernetes, CI/CD</div>
                        <div class="tech-item"><strong>Deployment:</strong><br>GitHub Actions, GitHub Pages</div>
                    </div>

                    <h3 style="color: #667eea; margin: 20px 0 15px 0;">ğŸš€ Full Application Features:</h3>
                    <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                        <li>User authentication and session management</li>
                        <li>50+ real dealerships across multiple states</li>
                        <li>Interactive review posting with sentiment analysis</li>
                        <li>Car database with 15+ models from 5 manufacturers</li>
                        <li>Admin panel for content management</li>
                        <li>Microservices architecture</li>
                        <li>Automated testing and deployment</li>
                    </ul>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h4>ğŸ”— Repository:</h4>
                        <p><a href="https://github.com/Braininhood/xrwvm-fullstack_developer_capstone" target="_blank" style="color: #667eea;">https://github.com/Braininhood/xrwvm-fullstack_developer_capstone</a></p>
                    </div>
                </div>
            </div>

            <script>
                console.log('ğŸš— Dealership Demo Application Loaded Successfully!');
                
                function showSection(section) {
                    // Hide all sections
                    document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
                    // Remove active class from all buttons
                    document.querySelectorAll('.nav button').forEach(btn => btn.classList.remove('active'));
                    
                    // Show selected section
                    document.getElementById(section + '-section').classList.remove('hidden');
                    // Add active class to clicked button
                    document.getElementById(section + '-btn').classList.add('active');
                }

                function filterDealers() {
                    const selectedState = document.getElementById('state-filter').value;
                    const dealerCards = document.querySelectorAll('.dealer-card');
                    let visibleCount = 0;
                    
                    dealerCards.forEach(card => {
                        const dealerInfo = card.querySelector('.dealer-info').textContent;
                        if (selectedState === 'all' || dealerInfo.includes(selectedState)) {
                            card.style.display = 'block';
                            visibleCount++;
                        } else {
                            card.style.display = 'none';
                        }
                    });
                    
                    document.getElementById('dealer-count').textContent = visibleCount + ' dealerships found';
                }

                function viewDealerReviews(dealerId, dealerName) {
                    showSection('reviews');
                    document.querySelector('#reviews-section h2').textContent = 'ğŸ“ Reviews for ' + dealerName;
                    
                    // Filter reviews for this dealer (simplified for demo)
                    const allReviews = document.querySelectorAll('.review-card');
                    allReviews.forEach(review => {
                        const reviewDealer = review.querySelector('div:last-child').textContent;
                        if (reviewDealer.includes(dealerName)) {
                            review.style.display = 'block';
                        } else {
                            review.style.display = 'none';
                        }
                    });
                }

                function showDealerDetails(name, address, location) {
                    alert('ğŸª ' + name + '\nğŸ“ ' + address + '\nğŸ™ï¸ ' + location + '\n\nâœ¨ This is a demo version. The full application includes detailed dealer profiles, contact information, and interactive features.');
                }

                // Initialize the demo
                document.addEventListener('DOMContentLoaded', function() {
                    console.log('ğŸ“Š Demo loaded with 5 dealers and 5 reviews');
                });
            </script>
        </body>
        </html>
        DEMO_EOF
        
        # Create separate JavaScript file to avoid YAML conflicts
        echo "âœ… Simple inline demo application created successfully"
        
    - name: Upload Demo Site
      uses: actions/upload-artifact@v4
      with:
        name: demo-site
        path: ./demo/
        retention-days: 30

  # Job 5: Deploy to GitHub Pages
  deploy:
    name: Deploy to GitHub Pages
    runs-on: ubuntu-latest
    needs: create-demo
    if: github.ref == 'refs/heads/main'
    steps:
    - name: Download Demo Site
      uses: actions/download-artifact@v4
      with:
        name: demo-site
        path: ./
        
    - name: Setup Pages
      uses: actions/configure-pages@v4
      with:
        enablement: true
        
    - name: Upload to GitHub Pages
      uses: actions/upload-pages-artifact@v3
      with:
        path: ./
        
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4

  # Job 6: Notification
  notify:
    name: Deployment Notification
    runs-on: ubuntu-latest
    needs: [deploy]
    if: always()
    steps:
    - name: Deployment Status
      run: |
        if [ "${{ needs.deploy.result }}" == "success" ]; then
          echo "ğŸ‰ Deployment successful!"
          echo "ğŸŒ Your application is live at: https://braininhood.github.io/xrwvm-fullstack_developer_capstone/"
          echo "ğŸ“± Share this link with anyone to showcase your project!"
        else
          echo "âŒ Deployment failed. Check the logs above."
        fi 